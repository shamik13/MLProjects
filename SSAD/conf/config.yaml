device: cuda:0

run_train:
  epoch: 3
  grad_enabled: False

dataset:
  S:
    base: /dgx/data/raw_dataset/data
    query:
      - folder == '20200610093341_H_ws2tobu_anomaly' &
        has_kizu == 1 &
        data_type == 'train'
  C:
    base: /dgx/data/raw_dataset/data
    query:
      - folder == '20200610093341_H_ws2tobu_anomaly' &
        has_kizu == 1 &
        data_type == 'train'
      - folder == '20200611140608_H_ws2tobu_normal' &
        has_kizu == 0 &
        data_type == 'train'
  test:
    base: /dgx/data/raw_dataset/data
    query:
      - folder == '20200610093341_H_ws2tobu_anomaly' &
        has_kizu == 1 &
        data_type == 'test'
      - folder == '20200610093341_H_ws2tobu_anomaly' &
        has_kizu == 0 &
        data_type == 'test'
      - folder == '20200611140608_H_ws2tobu_normal' &
        has_kizu == 0 &
        data_type == 'test'

dataloader:
  S:
    batch_size: 16
    shuffle: True
  C:
    batch_size: 16
    shuffle: True
  test:
    batch_size: 1
    shuffle: True

model:
  S:
    name: DeepLabV3
    pth:
    args:
      pretrained: True
      num_classes: 2
  C:
    name: VGG19
    pth:
    args:
      pretrained: True
      in_channels: 2
      out_features: 2

augs:
  height: 64
  width: 64
  S:
    yaml: /dgx/github/SSAD/ssad/conf/augs/train_semseg.yaml
    args:
      Resize:
        height: ${augs.height}
        width: ${augs.width}
  C:
    yaml: /dgx/github/SSAD/ssad/conf/augs/train_classifier.yaml
    args:
      Resize:
        height: ${augs.height}
        width: ${augs.width}
  test:
    yaml: /dgx/github/SSAD/ssad/conf/augs/test.yaml
    args:
      Resize:
        height: ${augs.height}
        width: ${augs.width}

optimizer:
  S:
    name: Adam
    args:
      lr: 0.0002
      weight_decay: 0.00001
  C:
    name: Adam
    args:
      lr: 0.0002
      weight_decay: 0.00001

criterion:
  S:
    name: CrossEntropy2D
    args:
      reduction: mean
  C:
    name: CrossEntropyLoss
    args:
